<div class="content__header">
  <h2>GROUPS</h2>
  <div class="div" *ngIf="!countdownService.isGroupsCountdownEnded()">{{ 'Please wait ' + countdownService.getGroupsCountdownValue() + ' seconds, until update button will become enabled'}}</div>
  <div class="btns__container">
    <button class="control__btn" [disabled]="!countdownService.isGroupsCountdownEnded() || (isGroupsLoading$ | async) || (groupsData$ | async)=== null" (click)="updateGroupsList()">{{'Update List' | uppercase}}</button>
    <button class="control__btn" (click)="onCreateGroup(createForm)" [disabled]="(isGroupsLoading$ | async)">{{'create group' | uppercase}}</button>
  </div>
</div>
<mat-progress-spinner
    class="loader"
    mode="indeterminate"
    *ngIf="isGroupsLoading$ | async"
    diameter="60"
></mat-progress-spinner>
<div class="content__items">
  <div *ngFor="let group of (groupsData$ | async)?.items" class="group-item" [class.groupCurrent]="currentUserId === group.createdBy.S">
    <a routerLink="/group/{{ group.id.S }}" class="group__link">
      <div class="group-property">{{ group.name.S }}</div>
    </a>
    <button class="delete__btn" *ngIf="currentUserId === group.createdBy.S" (click)="onDeleteGroup($event, group.id.S)">✕</button>
  </div>
</div>

<ng-template #createForm>
  <div class="create-form">
    <form [formGroup]="groupCreateForm" (ngSubmit)="onCreateFormSubmit()">
      <app-form-control
          label="{{ 'name:' | uppercase }}"
          controlName="name"
          [control]="groupCreateForm.get('name')"
          type="text"
          [readonly]="false"
        ></app-form-control>
      <button
        [disabled]="(isGroupsLoading$ | async) || groupCreateForm.invalid"
      >
      {{ 'Create Group' | uppercase }}
      </button>
    </form>
    <button (click)="onDialogClose()" class="close__btn">✕</button>
  </div>
</ng-template>
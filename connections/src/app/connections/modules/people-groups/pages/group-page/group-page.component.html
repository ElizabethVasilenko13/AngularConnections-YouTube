<section class="group-dialog">
  <div class="group-dialog__header">
    <div class="content">
      <div class="header__title">
        <a routerLink="/" class="header__control" title="Go to main page">
          <mat-icon>keyboard_arrow_left</mat-icon>
        </a>
        <h2>
          {{
            'Group ' + '"' + ((groupDialogData$ | async)?.name?.S || '') + '"'
              | uppercase
          }}
        </h2>
      </div>
      <div class="header__controls">
        <button
          (click)="groupPageService.updateGroupDialog(groupID,  groupDialogData$)"
          class="group__btn"
          [disabled]="
            !countdownService.isCountdownEnded('groupDailog' + groupID) ||
            (isGroupDialogLoading$ | async)
          "
        >
          {{ 'Update messages' | uppercase }}
        </button>
        <button
          *ngIf="isGroupCreatedByCurrnetUser$ | async"
          (click)="groupsService.onDeleteGroup($event, groupID, true)"
          class="header__control header__control-delete"
          [disabled]="isGroupDialogLoading$ | async"
          title="Delete group"
        >
          <mat-icon>delete</mat-icon>
        </button>
      </div>
    </div>
    <div
      class="user__message"
      *ngIf="!countdownService.isCountdownEnded('groupDailog' + groupID)"
    >
      {{
        'Please wait ' +
          countdownService.getCountdownValue('groupDailog' + groupID) +
          ' seconds, until update button will become enabled'
      }}
    </div>
  </div>
  <app-loader [isLoading]="isGroupDialogLoading$ | async"></app-loader>
  <div class="group-dialog__main">
    <app-messages-list [messages$]="(groupDialogData$ | async)?.messages" [currentUserID]="currentUserID"></app-messages-list>
    <div class="create__message">
      <form [formGroup]="groupPageService.createMessageForm" class="message__form">
        <div class="message__input">
          <app-form-control
            className="message-form"
            label="{{ '' | uppercase }}"
            controlName="text"
            [control]="groupPageService.createMessageForm.get('text')"
            type="text"
            [readonly]="false"
          ></app-form-control>
        </div>
        <button
          (click)="groupPageService.sendMessage(groupID, groupDialogData$)"
          class="group__btn"
          [disabled]="
            (isGroupDialogLoading$ | async) ||
            groupPageService.createMessageForm.invalid
          "
        >
          {{ 'send' | uppercase }}
        </button>
      </form>
    </div>
  </div>
</section>
